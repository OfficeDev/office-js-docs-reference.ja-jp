### YamlMime:UniversalReference
ms.openlocfilehash: 45f7cc7ea0d9cec7b247ef8ace1eccdb788bbcc1
ms.sourcegitcommit: c1149d24b38f20daf9ce690cd0761ec1ceb7333d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/17/2018
ms.locfileid: "25580831"
items:
- uid: office.Office.AddinCommands.Event
  summary: <span data-ttu-id="deafe-p101">event オブジェクトは、UI を使用しないコマンド ボタンによって呼び出されるアドイン関数のパラメーターとして渡されます。オブジェクトにより、アドインはどのボタンがクリックされたかを識別し、その処理を行ったホストにシグナルを送ることができます。</span><span class="sxs-lookup"><span data-stu-id="deafe-p101">The event object is passed as a parameter to add-in functions invoked by UI-less command buttons. The object allows the add-in to identify which button was clicked and to signal the host that it has completed its processing.</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="deafe-103">アドインの種類</span><span class="sxs-lookup"><span data-stu-id="deafe-103">Add-in type</span></span></td><td><span data-ttu-id="deafe-104">コンテンツ、作業ウィンドウ、Outlook</span><span class="sxs-lookup"><span data-stu-id="deafe-104">Content, task pane, Outlook</span></span></td></tr>


    <tr><td>[<span data-ttu-id="deafe-105">最小限のアクセス許可のレベル</span><span class="sxs-lookup"><span data-stu-id="deafe-105"> Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="deafe-106">制限あり</span><span class="sxs-lookup"><span data-stu-id="deafe-106">Restricted</span></span></td></tr>


    <tr><td>[<span data-ttu-id="deafe-107">適用可能な Outlook のモード</span><span class="sxs-lookup"><span data-stu-id="deafe-107"> Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="deafe-108">作成または読み込み</span><span class="sxs-lookup"><span data-stu-id="deafe-108">Compose or Read</span></span></td></tr></table>
  name: Office.AddinCommands.Event
  fullName: office.Office.AddinCommands.Event
  langs:
  - typeScript
  type: interface
  package: office
  children:
  - office.Office.AddinCommands.Event.completed
  - office.Office.AddinCommands.Event.source
- uid: office.Office.AddinCommands.Event.completed
  summary: >-
    <span data-ttu-id="deafe-109">アドインが、アドイン コマンド ボタンまたはイベント ハンドラーによりトリガーされた処理を完了したことを示します。</span><span class="sxs-lookup"><span data-stu-id="deafe-109">Indicates that the add-in has completed processing that was triggered by an add-in command button or event handler.</span></span>


    <span data-ttu-id="deafe-p102">このメソッドは、xsi:type 属性が ExecuteFunction に設定された Action 要素で定義されたアドイン コマンドにより呼び出された関数の最後に呼び出される必要があります。このメソッドを呼び出すと、関数が終了したことと、関数の呼び出しに関連するすべての状態をクリーンアップできることがホスト クライアントに通知されます。たとえば、ユーザーがこのメソッドを呼び出す前に Outlook を終了すると、関数が実行中であることが Outlook により警告されます。</span><span class="sxs-lookup"><span data-stu-id="deafe-p102">This method must be called at the end of a function which was invoked by an add-in command defined with an Action element with an xsi:type attribute set to ExecuteFunction. Calling this method signals the host client that the function is complete and that it can clean up any state involved with invoking the function. For example, if the user closes Outlook before this method is called, Outlook will warn that a function is still executing.</span></span>


    <span data-ttu-id="deafe-113">このメソッドは、イベントの処理が完了した後、Office.context.mailbox.addHandlerAsync 経由で追加されたイベント ハンドラーで呼び出される必要があります。</span><span class="sxs-lookup"><span data-stu-id="deafe-113">This method must be called in an event handler added via Office.context.mailbox.addHandlerAsync after completing processing of the event.</span></span>


    <span data-ttu-id="deafe-114">\[[API セット: メールボックス 1.3](/office/dev/add-ins/reference/javascript-api-for-office)\]</span><span class="sxs-lookup"><span data-stu-id="deafe-114">\[ [API set: Mailbox 1.3](/office/dev/add-ins/reference/javascript-api-for-office) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="deafe-115">最小限のアクセス許可のレベル</span><span class="sxs-lookup"><span data-stu-id="deafe-115"> Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="deafe-116">制限あり</span><span class="sxs-lookup"><span data-stu-id="deafe-116">Restricted</span></span></td></tr>


    <tr><td>[<span data-ttu-id="deafe-117">適用可能な Outlook のモード</span><span class="sxs-lookup"><span data-stu-id="deafe-117"> Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="deafe-118">作成または読み取り</span><span class="sxs-lookup"><span data-stu-id="deafe-118">Compose or read</span></span></td></tr></table>


    <span data-ttu-id="deafe-119">**サポートの詳細**</span><span class="sxs-lookup"><span data-stu-id="deafe-119">**Support details**</span></span>


    <span data-ttu-id="deafe-p103">次の表で、大文字 Y は、このメソッドは、対応する Office ホスト アプリケーションでサポートされていることを示します。空のセルは、Office ホスト アプリケーションでこのメソッドをサポートしないことを示します。</span><span class="sxs-lookup"><span data-stu-id="deafe-p103">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="deafe-122">Office ホスト アプリケーションとサーバーの要件の詳細については、 [Office アドインを実行するための要件](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)を参照してください<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="deafe-122">For more information about Office host application and server requirements, see [ Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="deafe-123">*サポートされるホスト (プラットフォーム別)*</span><span class="sxs-lookup"><span data-stu-id="deafe-123">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="deafe-124">Windows デスクトップ版 Office</span><span class="sxs-lookup"><span data-stu-id="deafe-124">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="deafe-125">Office Online (ブラウザー)</span><span class="sxs-lookup"><span data-stu-id="deafe-125">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="deafe-126">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="deafe-126">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="deafe-127"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="deafe-127"><strong> Excel </strong></span></span></td><td> <span data-ttu-id="deafe-128">Y</span><span class="sxs-lookup"><span data-stu-id="deafe-128">Y</span></span> </td><td> <span data-ttu-id="deafe-129">Y</span><span class="sxs-lookup"><span data-stu-id="deafe-129">Y</span></span> </td><td> <span data-ttu-id="deafe-130">Y</span><span class="sxs-lookup"><span data-stu-id="deafe-130">Y</span></span> </td></tr> <tr><td><span data-ttu-id="deafe-131"><strong>Outlook</strong></span><span class="sxs-lookup"><span data-stu-id="deafe-131"><strong> Outlook </strong></span></span></td><td> <span data-ttu-id="deafe-132">Y (メールボックス 1.3)</span><span class="sxs-lookup"><span data-stu-id="deafe-132">Y (Mailbox 1.3)</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id="deafe-133"><strong>PowerPoint</strong></span><span class="sxs-lookup"><span data-stu-id="deafe-133"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id="deafe-134">Y</span><span class="sxs-lookup"><span data-stu-id="deafe-134">Y</span></span> </td><td> <span data-ttu-id="deafe-135">Y</span><span class="sxs-lookup"><span data-stu-id="deafe-135">Y</span></span> </td><td> <span data-ttu-id="deafe-136">Y</span><span class="sxs-lookup"><span data-stu-id="deafe-136">Y</span></span> </td></tr> <tr><td><span data-ttu-id="deafe-137"><strong>単語</strong></span><span class="sxs-lookup"><span data-stu-id="deafe-137"><strong> Word </strong></span></span></td><td> <span data-ttu-id="deafe-138">Y</span><span class="sxs-lookup"><span data-stu-id="deafe-138">Y</span></span> </td><td> <span data-ttu-id="deafe-139">Y</span><span class="sxs-lookup"><span data-stu-id="deafe-139">Y</span></span> </td><td> <span data-ttu-id="deafe-140">Y</span><span class="sxs-lookup"><span data-stu-id="deafe-140">Y</span></span> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="deafe-141">例</span><span class="sxs-lookup"><span data-stu-id="deafe-141">Examples</span></span>


    ```javascript

    function processItem (event) {
        // Do some processing

        event.completed();
    }


    // In the following example, the checkMessage function has

    // been registered as an event handler for ItemSend.

    function checkMessage(event) {
        // Get the item being sent
        var outgoingMsg = Office.context.mailbox.item;

        // Check if subject contains "BLOCK"
        outgoingMsg.subject.getAsync(function (result) {
            // Subject is in result.value
            if (result.value.indexOf('BLOCK') != -1) {
                // Value is found, stop send
                event.completed({allowEvent = false});
            } else {
                // Value wasn't found, allow send
                event.completed({allowEvent = true});
            }
        });
    }

    ```
  name: completed(options)
  fullName: office.Office.AddinCommands.Event.completed
  langs:
  - typeScript
  type: method
  syntax:
    content: 'completed(options?: any): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: '<span data-ttu-id="deafe-142">省略可能。</span><span class="sxs-lookup"><span data-stu-id="deafe-142">Optional.</span></span> <span data-ttu-id="deafe-143">次のプロパティのうち 1 つ以上を含むオブジェクト リテラル。</span><span class="sxs-lookup"><span data-stu-id="deafe-143">An object literal that contains one or more of the following properties.</span></span> <span data-ttu-id="deafe-144">allowEvent: ブール値です。</span><span class="sxs-lookup"><span data-stu-id="deafe-144">allowEvent: A boolean value.</span></span> <span data-ttu-id="deafe-145">この値は、処理するイベントのイベント ハンドラーの完了を通知するのには、完成したメソッドを使用するときは実行を継続する必要があります。 またはキャンセルします。</span><span class="sxs-lookup"><span data-stu-id="deafe-145">When the completed method is used to signal completion of an event handler, this value indicates of the handled event should continue execution or be canceled.</span></span> <span data-ttu-id="deafe-146">たとえば、ItemSend イベントを処理するアドインを設定できます allowEvent = false に設定すると、メッセージの送信をキャンセルします。</span><span class="sxs-lookup"><span data-stu-id="deafe-146">For example, an add-in that handles the ItemSend event can set allowEvent = false to cancel sending of the message.</span></span>'
      type:
      - any
- uid: office.Office.AddinCommands.Event.source
  summary: >-
    <span data-ttu-id="deafe-147">この関数の呼び出しをトリガーしたコントロールについて説明します。</span><span class="sxs-lookup"><span data-stu-id="deafe-147">Information about the control that triggered calling this function.</span></span>


    <span data-ttu-id="deafe-148">**サポートの詳細**</span><span class="sxs-lookup"><span data-stu-id="deafe-148">**Support details**</span></span>


    <span data-ttu-id="deafe-p105">次の表で、大文字 Y は、このプロパティは、対応する Office ホスト アプリケーションでサポートされていることを示します。空のセルは、Office ホスト アプリケーションでこのプロパティをサポートしないことを示します。</span><span class="sxs-lookup"><span data-stu-id="deafe-p105">A capital Y in the following matrix indicates that this property is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this property.</span></span>


    <span data-ttu-id="deafe-151">Office ホスト アプリケーションとサーバーの要件の詳細については、 [Office アドインを実行するための要件](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)を参照してください<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="deafe-151">For more information about Office host application and server requirements, see [ Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="deafe-152">*サポートされるホスト (プラットフォーム別)*</span><span class="sxs-lookup"><span data-stu-id="deafe-152">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="deafe-153">Windows デスクトップ版 Office</span><span class="sxs-lookup"><span data-stu-id="deafe-153">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="deafe-154">Office Online (ブラウザー)</span><span class="sxs-lookup"><span data-stu-id="deafe-154">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="deafe-155">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="deafe-155">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="deafe-156"><strong>Outlook</strong></span><span class="sxs-lookup"><span data-stu-id="deafe-156"><strong> Outlook </strong></span></span></td><td> <span data-ttu-id="deafe-157">Y (メールボックス 1.3)</span><span class="sxs-lookup"><span data-stu-id="deafe-157">Y (Mailbox 1.3)</span></span> </td><td> </td><td> </td></tr> </table>
  name: source
  fullName: office.Office.AddinCommands.Event.source
  langs:
  - typeScript
  type: property
  syntax:
    content: 'source: Source;'
    return:
      type:
      - office.Office.AddinCommands.Source
      description: "\n#### <a name=\"examples\"></a><span data-ttu-id=\"deafe-158\">例</span><span class=\"sxs-lookup\"><span data-stu-id=\"deafe-158\">Examples</span></span>\n\n```javascript\n// In this example, consider a button defined in an add-in manifest as follows:\n<Control xsi:type=\"Button\" id=\"eventTestButton\">\n    <Label resid=\"eventButtonLabel\" />\n    <Tooltip resid=\"eventButtonTooltip\" />\n    <Supertip>\n        <Title resid=\"eventSuperTipTitle\" />\n        <Description resid=\"eventSuperTipDescription\" />\n    </Supertip>\n    <Icon>\n        <bt:Image size=\"16\" resid=\"blue-icon-16\" />\n        <bt:Image size=\"32\" resid=\"blue-icon-32\" />\n        <bt:Image size=\"80\" resid=\"blue-icon-80\" />\n    </Icon>\n    <Action xsi:type=\"ExecuteFunction\">\n        <FunctionName>testEventObject</FunctionName>\n    </Action>\n</Control>\n// The button has an id attribute set to eventTestButton, and will invoke\n// the testEventObject function defined in the add-in.\n// That function looks like this:\nfunction testEventObject(event) {\n    // The event object implements the Event interface\n\n    // This value will be \"eventTestButton\"\n    var buttonId = event.source.id;\n\n    // Signal to the host app that processing is complete.\n    event.completed();\n}\n```\n```javascript\n// Function is used by two buttons:\n// button1 and button2\nfunction multiButton (event) {\n    // Check which button was clicked\n    var buttonId = event.source.id;\n\n    if (buttonId === 'button1') {\n        doButton1Action();\n    }\n    else {\n        doButton2Action();\n    }\n\n    event.completed();\n}\n```"
