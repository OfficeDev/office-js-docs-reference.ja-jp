# <a name="how-the-office-javascript-api-documentation-is-generated"></a><span data-ttu-id="a21c8-101">Office JavaScript API ドキュメントの生成方法</span><span class="sxs-lookup"><span data-stu-id="a21c8-101">How the Office JavaScript API documentation is generated</span></span>

<span data-ttu-id="a21c8-102">Office JavaScript リファレンスドキュメントページは、型定義ファイルおよびスニペットの例から生成されます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-102">The Office JavaScript reference documentation pages are generated from type definition files and example snippets.</span></span> <span data-ttu-id="a21c8-103">このプロセスでは、オープンソースツールとリポジトリ固有のスクリプトの組み合わせを使用します。</span><span class="sxs-lookup"><span data-stu-id="a21c8-103">This process uses a blend of open source tools and repository-specific scripts.</span></span> <span data-ttu-id="a21c8-104">このドキュメントは、このリポジトリのプロセスを透過的にすることを目的としており、コミュニティがこのコンテンツをより効果的に活用し、投稿できるようにします。</span><span class="sxs-lookup"><span data-stu-id="a21c8-104">This document aims to make the processes of this repository transparent so the community can better benefit from and contribute to this content.</span></span>

## <a name="content-sources"></a><span data-ttu-id="a21c8-105">コンテンツ ソース</span><span class="sxs-lookup"><span data-stu-id="a21c8-105">Content sources</span></span>

<span data-ttu-id="a21c8-106">Office JS リファレンスドキュメントを作成するために、次の2種類のコンテンツが組み合わされています。型定義とコードスニペット。</span><span class="sxs-lookup"><span data-stu-id="a21c8-106">Two types of content are combined to create the Office-JS reference documentation: type definitions and code snippets.</span></span> <span data-ttu-id="a21c8-107">これにより、完全な API の適用範囲が保証され、小さなインラインコードサンプルが提供されます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-107">These ensure complete API coverage and give small, inline code samples.</span></span>

### <a name="type-definition-files"></a><span data-ttu-id="a21c8-108">型定義ファイル</span><span class="sxs-lookup"><span data-stu-id="a21c8-108">Type definition files</span></span>

<span data-ttu-id="a21c8-109">完全に[入力されている](https://github.com/DefinitelyTyped/DefinitelyTyped)型定義ファイルは、ドキュメントの真実の単一のソースです。</span><span class="sxs-lookup"><span data-stu-id="a21c8-109">The type definition files on [Definitely Typed](https://github.com/DefinitelyTyped/DefinitelyTyped) are the single source of truth for the documentation.</span></span> <span data-ttu-id="a21c8-110">TypeScript を使用する Office アドインは、これらの型定義ファイルを使用してコンパイルされます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-110">Any Office Add-in that uses TypeScript compiles by using these type definition files.</span></span> <span data-ttu-id="a21c8-111">これらは、JavaScript および TypeScript 開発者にも IntelliSense 機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="a21c8-111">These also give JavaScript and TypeScript developers IntelliSense capabilities.</span></span> <span data-ttu-id="a21c8-112">これらの定義から参照ドキュメントを作成することで、より正確な情報が得られます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-112">By building the reference documentation from these definitions, we provide more accurate information.</span></span>

<span data-ttu-id="a21c8-113">各ドキュメントのサブセクションのソースコンテンツを提供する、4つの関連する d. ファイルがあります。</span><span class="sxs-lookup"><span data-stu-id="a21c8-113">There are four relevant d.ts files that provide source content for different subsections of the docs.</span></span>

- <span data-ttu-id="a21c8-114">[office-js/d-u-n-s](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (リリースの定義)</span><span class="sxs-lookup"><span data-stu-id="a21c8-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (The Release definitions.)</span></span>
  - [<span data-ttu-id="a21c8-115">Excel (リリース)</span><span class="sxs-lookup"><span data-stu-id="a21c8-115">Excel (Release)</span></span>](https://docs.microsoft.com/javascript/api/excel_release)
  - [<span data-ttu-id="a21c8-116">OneNote</span><span class="sxs-lookup"><span data-stu-id="a21c8-116">OneNote</span></span>](https://docs.microsoft.com/javascript/api/onenote)
  - [<span data-ttu-id="a21c8-117">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="a21c8-117">PowerPoint</span></span>](https://docs.microsoft.com/javascript/api/powerpoint)
  - [<span data-ttu-id="a21c8-118">Visio</span><span class="sxs-lookup"><span data-stu-id="a21c8-118">Visio</span></span>](https://docs.microsoft.com/javascript/api/visio)
  - [<span data-ttu-id="a21c8-119">Word (リリース)</span><span class="sxs-lookup"><span data-stu-id="a21c8-119">Word (Release)</span></span>](https://docs.microsoft.com/javascript/api/word_release)
  - [<span data-ttu-id="a21c8-120">共通 API の OfficeExtensions サブセクション</span><span class="sxs-lookup"><span data-stu-id="a21c8-120">OfficeExtensions subsection of the Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="a21c8-121">[office-js-プレビュー/インデックス](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts)(プレビューの定義)</span><span class="sxs-lookup"><span data-stu-id="a21c8-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (The Preview definitions.)</span></span>
  - [<span data-ttu-id="a21c8-122">Excel (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="a21c8-122">Excel (Preview)</span></span>](https://docs.microsoft.com/javascript/api/excel)
  - [<span data-ttu-id="a21c8-123">Outlook (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="a21c8-123">Outlook (Preview)</span></span>](https://docs.microsoft.com/javascript/api/outlook)
  - [<span data-ttu-id="a21c8-124">Word (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="a21c8-124">Word (Preview)</span></span>](https://docs.microsoft.com/javascript/api/word)
  - [<span data-ttu-id="a21c8-125">共通 API</span><span class="sxs-lookup"><span data-stu-id="a21c8-125">Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="a21c8-126">[カスタム-関数-ランタイム](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts)(Excel カスタム関数ランタイム定義)</span><span class="sxs-lookup"><span data-stu-id="a21c8-126">[custom-functions-runtime](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts)(The Excel Custom Functions runtime definitions.)</span></span>
  - [<span data-ttu-id="a21c8-127">カスタム関数</span><span class="sxs-lookup"><span data-stu-id="a21c8-127">Custom Functions</span></span>](https://docs.microsoft.com/javascript/api/custom-functions-runtime)
- <span data-ttu-id="a21c8-128">[office ランタイム](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts)(カスタム関数プラットフォームの office ランタイム定義)</span><span class="sxs-lookup"><span data-stu-id="a21c8-128">[office-runtime](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts)(The office runtime definitions for the Custom Functions platform.)</span></span>
  - [<span data-ttu-id="a21c8-129">Office ランタイム</span><span class="sxs-lookup"><span data-stu-id="a21c8-129">Office Runtime</span></span>](https://docs.microsoft.com/javascript/api/office-runtime)

<span data-ttu-id="a21c8-130">以前のバージョンの Api には独自の d-u-n-s ファイルがあります。</span><span class="sxs-lookup"><span data-stu-id="a21c8-130">Older versions of the APIs have their own d.ts files.</span></span> <span data-ttu-id="a21c8-131">これらは、新しい API 要件セットがリリースされるときに保持されます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-131">These are preserved when a new API requirement set is released.</span></span> <span data-ttu-id="a21c8-132">また、[バージョン Remover ツール](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts)を使用して生成することもできます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-132">They can also be generated using the [Version Remover tool](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span></span> <span data-ttu-id="a21c8-133">これらの古い d-u-n-s ファイルは保持されているため、イベント Api にパッチまたは変更があっても、元の動作はまだ文書化されています。</span><span class="sxs-lookup"><span data-stu-id="a21c8-133">These old d.ts files are maintained so that in the event APIs are patched or altered, the original behavior is still documented.</span></span> <span data-ttu-id="a21c8-134">これは、古いバージョンの API を対象にする必要がある場合に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-134">This is useful if you have to target an older version of the API.</span></span>

### <a name="code-snippets"></a><span data-ttu-id="a21c8-135">コード スニペット</span><span class="sxs-lookup"><span data-stu-id="a21c8-135">Code snippets</span></span>

<span data-ttu-id="a21c8-136">コード例スニペットは、2つのソースから参照ページに追加されます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-136">Code example snippets are added to the reference pages from two sources:</span></span>

- [<span data-ttu-id="a21c8-137">スクリプトラボサンプル</span><span class="sxs-lookup"><span data-stu-id="a21c8-137">Script Lab Samples</span></span>](https://github.com/OfficeDev/office-js-snippets)
- [<span data-ttu-id="a21c8-138">ローカルコードスニペット</span><span class="sxs-lookup"><span data-stu-id="a21c8-138">Local Code Snippets</span></span>](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/code-snippets)

<span data-ttu-id="a21c8-139">ローカルスニペットは、ホスト固有の yaml ファイルにあります。</span><span class="sxs-lookup"><span data-stu-id="a21c8-139">The local snippets are in host-specific yaml files.</span></span> <span data-ttu-id="a21c8-140">これらのコンテンツはクラスとフィールドによって整理されているため、参照ページ内の適切な場所にマップできます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-140">Their content is organized by class and field, so it can be mapped to the appropriate place in a reference page.</span></span> <span data-ttu-id="a21c8-141">スニペットの言語 (JavaScript または TypeScript) は、await ステートメントの使用によって推論されます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-141">The language of the snippet (JavaScript or TypeScript) is inferred by the use of await statements.</span></span>

<span data-ttu-id="a21c8-142">スクリプトラボスニペットは、作業用サンプルから引き出されています。</span><span class="sxs-lookup"><span data-stu-id="a21c8-142">The Script Lab snippets are pulled from working samples.</span></span> <span data-ttu-id="a21c8-143">現在、Excel と Word のサンプルは、[マッピングファイルのペア](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata)を使用して、参照文書のセクションにマップされています。</span><span class="sxs-lookup"><span data-stu-id="a21c8-143">Currently, Excel and Word samples are mapped to reference document sections through a [pair of mapping files](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata).</span></span> <span data-ttu-id="a21c8-144">これらは、個々のサンプルメソッドを API のプロパティまたはメソッドと照合します。</span><span class="sxs-lookup"><span data-stu-id="a21c8-144">These match individual sample methods to properties or methods in the API.</span></span> <span data-ttu-id="a21c8-145">Office js-スニペットリポジトリを`yarn start`実行すると、すべてのマップされたスニペットを含む[yaml ファイル](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml)が作成されます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-145">When the office-js-snippets repository's `yarn start` runs, [a yaml file](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml) containing all the mapped snippets is created.</span></span> <span data-ttu-id="a21c8-146">この yaml ファイルは、リファレンスドキュメントツールへの入力です。</span><span class="sxs-lookup"><span data-stu-id="a21c8-146">This yaml file is the input into the reference documentation tooling.</span></span>

## <a name="tooling-pipeline"></a><span data-ttu-id="a21c8-147">ツールパイプライン</span><span class="sxs-lookup"><span data-stu-id="a21c8-147">Tooling pipeline</span></span>

![明示的に入力された制御フロー、プリプロセッサ、API 抽出器、midprocessor、API の解析、およびポストプロセッサへの制御フローを示すイメージ。](ToolingPipeline.png)

<span data-ttu-id="a21c8-149">コンテンツソースと最終ページの間では、ドキュメントのコンテンツは5つのツールステップを通過します。</span><span class="sxs-lookup"><span data-stu-id="a21c8-149">Between the content sources and the final pages, the documentation content goes through five tooling steps:</span></span>

1. [<span data-ttu-id="a21c8-150">プリプロセッサスクリプト</span><span class="sxs-lookup"><span data-stu-id="a21c8-150">Preprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/preprocessor.ts)
1. [<span data-ttu-id="a21c8-151">API 抽出器</span><span class="sxs-lookup"><span data-stu-id="a21c8-151">API Extractor</span></span>](https://api-extractor.com/)
1. [<span data-ttu-id="a21c8-152">Midprocessor スクリプト</span><span class="sxs-lookup"><span data-stu-id="a21c8-152">Midprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/midprocessor.ts)
1. [<span data-ttu-id="a21c8-153">API の解析の方法</span><span class="sxs-lookup"><span data-stu-id="a21c8-153">API Documenter</span></span>](https://github.com/microsoft/rushstack/blob/master/apps/api-documenter/README.md)
1. [<span data-ttu-id="a21c8-154">ポストプロセッサスクリプト</span><span class="sxs-lookup"><span data-stu-id="a21c8-154">Postprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/postprocessor.ts)

<span data-ttu-id="a21c8-155">プリプロセッサは、d-u-n-s ファイルを取得し、それらをホスト固有のセクションに分割します。</span><span class="sxs-lookup"><span data-stu-id="a21c8-155">The preprocessor takes the d.ts files and splits them into host-specific sections.</span></span> <span data-ttu-id="a21c8-156">今後のツールがデータを適切に処理するために必要なクリーンアップが実行されます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-156">It performs any cleanup necessary for the subsequent tools to properly process the data.</span></span>

<span data-ttu-id="a21c8-157">API エクストラクターは、d-u-n-s ファイルを JSON データに変換します。</span><span class="sxs-lookup"><span data-stu-id="a21c8-157">API Extractor converts the d.ts files into JSON data.</span></span> <span data-ttu-id="a21c8-158">このトークンは、解析を簡単にするために、すべての型データを有効にします。</span><span class="sxs-lookup"><span data-stu-id="a21c8-158">This tokenizes all the type data, allowing for easier parsing.</span></span>

<span data-ttu-id="a21c8-159">Midprocessor は、コードスニペットを取得し、適切なホストとペアにします。</span><span class="sxs-lookup"><span data-stu-id="a21c8-159">The midprocessor retrieves the code snippets and pairs them with the proper hosts.</span></span>

<span data-ttu-id="a21c8-160">API 解析ツールは、JSON データを yml ファイルに変換します。</span><span class="sxs-lookup"><span data-stu-id="a21c8-160">API Documenter converts the JSON data into .yml files.</span></span> <span data-ttu-id="a21c8-161">Yml ファイルは、ドキュメントを docs.microsoft.com に公開する Open Publishing システムによって markdown に変換されます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-161">The .yml files are converted to markdown by the Open Publishing System that publishes our docs to docs.microsoft.com.</span></span> <span data-ttu-id="a21c8-162">API の解析には、コードスニペットを挿入する Office 固有の拡張機能も含まれています。</span><span class="sxs-lookup"><span data-stu-id="a21c8-162">API Documenter also contains an Office-specific extension that inserts our code snippets.</span></span>

<span data-ttu-id="a21c8-163">ポストプロセッサは、目次をクリーンアップし、yml ファイルを[発行フォルダー](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen)に移動します。</span><span class="sxs-lookup"><span data-stu-id="a21c8-163">The postprocessor cleans up the table of contents and moves the .yml files into the [publishing folder](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span></span>

<span data-ttu-id="a21c8-164">次の5つの手順はすべて、 [Generatedocs](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd)が実行されたときに実行されます。</span><span class="sxs-lookup"><span data-stu-id="a21c8-164">All five of these steps are performed when [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) is run.</span></span> <span data-ttu-id="a21c8-165">このスクリプトは、ノードモジュールのインストール、古いファイルセットのクリーンアップ、および各要件セットのバージョンタイプの定義ファイルも処理します。</span><span class="sxs-lookup"><span data-stu-id="a21c8-165">That script also handles node module installation, cleans out old file sets, and versions Type Definition files for each requirement set.</span></span>
