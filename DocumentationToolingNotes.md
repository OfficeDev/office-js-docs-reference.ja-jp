# <a name="how-the-office-javascript-api-documentation-is-generated"></a><span data-ttu-id="6c693-101">JavaScript API Office生成される方法</span><span class="sxs-lookup"><span data-stu-id="6c693-101">How the Office JavaScript API documentation is generated</span></span>

<span data-ttu-id="6c693-102">JavaScript Officeドキュメント ページは、型定義ファイルとサンプル スニペットから生成されます。</span><span class="sxs-lookup"><span data-stu-id="6c693-102">The Office JavaScript reference documentation pages are generated from type definition files and example snippets.</span></span> <span data-ttu-id="6c693-103">このプロセスでは、オープン ソース ツールとリポジトリ固有のスクリプトのブレンドを使用します。</span><span class="sxs-lookup"><span data-stu-id="6c693-103">This process uses a blend of open source tools and repository-specific scripts.</span></span> <span data-ttu-id="6c693-104">このドキュメントでは、コミュニティがこのコンテンツのメリットを高め、投稿できるよう、このリポジトリのプロセスを透過的に提供します。</span><span class="sxs-lookup"><span data-stu-id="6c693-104">This document aims to make the processes of this repository transparent so the community can better benefit from and contribute to this content.</span></span>

## <a name="content-sources"></a><span data-ttu-id="6c693-105">コンテンツ ソース</span><span class="sxs-lookup"><span data-stu-id="6c693-105">Content sources</span></span>

<span data-ttu-id="6c693-106">Office-JS リファレンス ドキュメントを作成するために、型定義とコード スニペットの 2 種類のコンテンツが組み合わされます。</span><span class="sxs-lookup"><span data-stu-id="6c693-106">Two types of content are combined to create the Office-JS reference documentation: type definitions and code snippets.</span></span> <span data-ttu-id="6c693-107">これらは完全な API カバレッジを確保し、小規模なインライン コード サンプルを提供します。</span><span class="sxs-lookup"><span data-stu-id="6c693-107">These ensure complete API coverage and give small, inline code samples.</span></span>

### <a name="type-definition-files"></a><span data-ttu-id="6c693-108">型定義ファイル</span><span class="sxs-lookup"><span data-stu-id="6c693-108">Type definition files</span></span>

<span data-ttu-id="6c693-109">[「](https://github.com/DefinitelyTyped/DefinitelyTyped)間違いなく型指定」の型定義ファイルは、ドキュメントの単一の真の情報源です。</span><span class="sxs-lookup"><span data-stu-id="6c693-109">The type definition files on [Definitely Typed](https://github.com/DefinitelyTyped/DefinitelyTyped) are the single source of truth for the documentation.</span></span> <span data-ttu-id="6c693-110">TypeScript Office使用するアドインは、これらの型定義ファイルを使用してコンパイルされます。</span><span class="sxs-lookup"><span data-stu-id="6c693-110">Any Office Add-in that uses TypeScript compiles by using these type definition files.</span></span> <span data-ttu-id="6c693-111">また、JavaScript と TypeScript の開発者は、IntelliSenseできます。</span><span class="sxs-lookup"><span data-stu-id="6c693-111">These also give JavaScript and TypeScript developers IntelliSense capabilities.</span></span> <span data-ttu-id="6c693-112">これらの定義から参照ドキュメントを作成することで、より正確な情報が提供されます。</span><span class="sxs-lookup"><span data-stu-id="6c693-112">By building the reference documentation from these definitions, we provide more accurate information.</span></span>

<span data-ttu-id="6c693-113">ドキュメントの異なるサブセクションのソース コンテンツを提供する 4 つの関連する d.ts ファイルがあります。</span><span class="sxs-lookup"><span data-stu-id="6c693-113">There are four relevant d.ts files that provide source content for different subsections of the docs.</span></span>

- <span data-ttu-id="6c693-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (リリース定義)</span><span class="sxs-lookup"><span data-stu-id="6c693-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (The Release definitions.)</span></span>
  - [<span data-ttu-id="6c693-115">Excel (リリース)</span><span class="sxs-lookup"><span data-stu-id="6c693-115">Excel (Release)</span></span>](https://docs.microsoft.com/javascript/api/excel_release)
  - [<span data-ttu-id="6c693-116">OneNote</span><span class="sxs-lookup"><span data-stu-id="6c693-116">OneNote</span></span>](https://docs.microsoft.com/javascript/api/onenote)
  - [<span data-ttu-id="6c693-117">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="6c693-117">PowerPoint</span></span>](https://docs.microsoft.com/javascript/api/powerpoint)
  - [<span data-ttu-id="6c693-118">Visio</span><span class="sxs-lookup"><span data-stu-id="6c693-118">Visio</span></span>](https://docs.microsoft.com/javascript/api/visio)
  - [<span data-ttu-id="6c693-119">Word (リリース)</span><span class="sxs-lookup"><span data-stu-id="6c693-119">Word (Release)</span></span>](https://docs.microsoft.com/javascript/api/word_release)
  - [<span data-ttu-id="6c693-120">共通 API の OfficeExtensions サブセクション</span><span class="sxs-lookup"><span data-stu-id="6c693-120">OfficeExtensions subsection of the Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="6c693-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (プレビュー定義)</span><span class="sxs-lookup"><span data-stu-id="6c693-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (The Preview definitions.)</span></span>
  - [<span data-ttu-id="6c693-122">Excel (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="6c693-122">Excel (Preview)</span></span>](https://docs.microsoft.com/javascript/api/excel)
  - [<span data-ttu-id="6c693-123">Outlook (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="6c693-123">Outlook (Preview)</span></span>](https://docs.microsoft.com/javascript/api/outlook)
  - [<span data-ttu-id="6c693-124">Word (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="6c693-124">Word (Preview)</span></span>](https://docs.microsoft.com/javascript/api/word)
  - [<span data-ttu-id="6c693-125">共通 API</span><span class="sxs-lookup"><span data-stu-id="6c693-125">Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="6c693-126">[custom-functions-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (Excel カスタム関数ランタイム定義)</span><span class="sxs-lookup"><span data-stu-id="6c693-126">[custom-functions-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (The Excel Custom Functions runtime definitions.)</span></span>
  - [<span data-ttu-id="6c693-127">カスタム関数</span><span class="sxs-lookup"><span data-stu-id="6c693-127">Custom Functions</span></span>](https://docs.microsoft.com/javascript/api/custom-functions-runtime)
- <span data-ttu-id="6c693-128">[office-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (カスタム関数プラットフォームの Office ランタイム定義)。</span><span class="sxs-lookup"><span data-stu-id="6c693-128">[office-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (The office runtime definitions for the Custom Functions platform.)</span></span>
  - [<span data-ttu-id="6c693-129">Office ランタイム</span><span class="sxs-lookup"><span data-stu-id="6c693-129">Office Runtime</span></span>](https://docs.microsoft.com/javascript/api/office-runtime)

<span data-ttu-id="6c693-130">以前のバージョンの API には独自の d.ts ファイルがあります。</span><span class="sxs-lookup"><span data-stu-id="6c693-130">Older versions of the APIs have their own d.ts files.</span></span> <span data-ttu-id="6c693-131">これらは、新しい API 要件セットがリリースされると保持されます。</span><span class="sxs-lookup"><span data-stu-id="6c693-131">These are preserved when a new API requirement set is released.</span></span> <span data-ttu-id="6c693-132">また、バージョン削除ツールを [使用して生成することもできます](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts)。</span><span class="sxs-lookup"><span data-stu-id="6c693-132">They can also be generated using the [Version Remover tool](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span></span> <span data-ttu-id="6c693-133">これらの古い d.ts ファイルは維持され、API に修正プログラムが適用または変更された場合でも、元の動作は文書化されます。</span><span class="sxs-lookup"><span data-stu-id="6c693-133">These old d.ts files are maintained so that in the event APIs are patched or altered, the original behavior is still documented.</span></span> <span data-ttu-id="6c693-134">これは、API の古いバージョンをターゲットとする必要がある場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="6c693-134">This is useful if you have to target an older version of the API.</span></span>

#### <a name="testing-type-definition-file-changes"></a><span data-ttu-id="6c693-135">型定義ファイルの変更のテスト</span><span class="sxs-lookup"><span data-stu-id="6c693-135">Testing type definition file changes</span></span>

<span data-ttu-id="6c693-136">JavaScript API のドキュメントOffice変更は、上記の 4 つの d.ts ファイルを編集することで行われます。</span><span class="sxs-lookup"><span data-stu-id="6c693-136">Any documentation changes for the Office JavaScript API are done by editing the four d.ts files mentioned above.</span></span> <span data-ttu-id="6c693-137">ただし [、generate-docs/script-inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) で対応するファイルを編集し [、GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd)を実行することで、PR を DefinitelyTyped に提出する前に変更をテストできます (たとえば、書式設定がマークダウンに変換される方法をテストする必要がある場合)。</span><span class="sxs-lookup"><span data-stu-id="6c693-137">However, you can test a change before submitting a PR to DefinitelyTyped (if you need to, for example, test how your formatting will translate into markdown) by editing the corresponding file in [generate-docs/script-inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) and running [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd).</span></span> <span data-ttu-id="6c693-138">メッセージが表示されたら、[ローカル ファイル] オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="6c693-138">When prompted, select the "Local files" option.</span></span>

<span data-ttu-id="6c693-139">このレポのリモート分岐に変更をプッシュすると、docs.microsoft.comプラットフォームでテスト分岐が作成されます。</span><span class="sxs-lookup"><span data-stu-id="6c693-139">Pushing changes to a remote branch of this repo causes the docs.microsoft.com platform to build a test branch.</span></span> <span data-ttu-id="6c693-140">この分岐は、内部の Microsoft review.docs.microsoft.comによってのみアクセス可能な場所にレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="6c693-140">This branch is rendered on review.docs.microsoft.com, which is only accessible by internal Microsoft personnel.</span></span> <span data-ttu-id="6c693-141">PR を確認するユーザーは、レビュー サイトの正確性を確認します。</span><span class="sxs-lookup"><span data-stu-id="6c693-141">Anyone reviewing your PR will check the review site for accuracy.</span></span>

### <a name="code-snippets"></a><span data-ttu-id="6c693-142">コード スニペット</span><span class="sxs-lookup"><span data-stu-id="6c693-142">Code snippets</span></span>

<span data-ttu-id="6c693-143">コード例スニペットは、次の 2 つのソースから参照ページに追加されます。</span><span class="sxs-lookup"><span data-stu-id="6c693-143">Code example snippets are added to the reference pages from two sources:</span></span>

- [<span data-ttu-id="6c693-144">Script Lab Samples</span><span class="sxs-lookup"><span data-stu-id="6c693-144">Script Lab Samples</span></span>](https://github.com/OfficeDev/office-js-snippets)
- [<span data-ttu-id="6c693-145">ローカル コード スニペット</span><span class="sxs-lookup"><span data-stu-id="6c693-145">Local Code Snippets</span></span>](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/code-snippets)

<span data-ttu-id="6c693-146">ローカル スニペットは、ホスト固有の yaml ファイルに含めます。</span><span class="sxs-lookup"><span data-stu-id="6c693-146">The local snippets are in host-specific yaml files.</span></span> <span data-ttu-id="6c693-147">コンテンツはクラスとフィールドごとに整理され、参照ページ内の適切な場所にマップできます。</span><span class="sxs-lookup"><span data-stu-id="6c693-147">Their content is organized by class and field, so it can be mapped to the appropriate place in a reference page.</span></span> <span data-ttu-id="6c693-148">スニペットの言語 (JavaScript または TypeScript) は、await ステートメントの使用によって推測されます。</span><span class="sxs-lookup"><span data-stu-id="6c693-148">The language of the snippet (JavaScript or TypeScript) is inferred by the use of await statements.</span></span>

<span data-ttu-id="6c693-149">Script Lab スニペットは、動作するサンプルから取得されます。</span><span class="sxs-lookup"><span data-stu-id="6c693-149">The Script Lab snippets are pulled from working samples.</span></span> <span data-ttu-id="6c693-150">現在、Excel、Outlook、PowerPoint、および Word のサンプルは、マッピング ファイルを使用してドキュメント セクションを参照するために [マップされています](https://github.com/OfficeDev/office-js-snippets/tree/prod/snippet-extractor-metadata)。</span><span class="sxs-lookup"><span data-stu-id="6c693-150">Currently, Excel, Outlook, PowerPoint, and Word samples are mapped to reference document sections through [mapping files](https://github.com/OfficeDev/office-js-snippets/tree/prod/snippet-extractor-metadata).</span></span> <span data-ttu-id="6c693-151">これらは、個々のサンプル メソッドを API のプロパティまたはメソッドに一致します。</span><span class="sxs-lookup"><span data-stu-id="6c693-151">These match individual sample methods to properties or methods in the API.</span></span> <span data-ttu-id="6c693-152">office-js-snippets リポジトリが実行されると、マップされたスニペットを含む `yarn start` [yaml](https://github.com/OfficeDev/office-js-snippets/blob/prod/snippet-extractor-output/snippets.yaml) ファイルが作成されます。</span><span class="sxs-lookup"><span data-stu-id="6c693-152">When the office-js-snippets repository's `yarn start` runs, [a yaml file](https://github.com/OfficeDev/office-js-snippets/blob/prod/snippet-extractor-output/snippets.yaml) containing all the mapped snippets is created.</span></span> <span data-ttu-id="6c693-153">この yaml ファイルは、リファレンス ドキュメント ツールへの入力です。</span><span class="sxs-lookup"><span data-stu-id="6c693-153">This yaml file is the input into the reference documentation tooling.</span></span>

## <a name="tooling-pipeline"></a><span data-ttu-id="6c693-154">ツール パイプライン</span><span class="sxs-lookup"><span data-stu-id="6c693-154">Tooling pipeline</span></span>

![間違いなく型指定されたコントロール フロー、プリプロセッサ、API 抽出器、中間プロセッサ、API Documenter、およびポストプロセッサへの制御フローを示す画像。](ToolingPipeline.png)

<span data-ttu-id="6c693-156">コンテンツ ソースと最終ページの間で、ドキュメント コンテンツは 5 つのツールステップを実行します。</span><span class="sxs-lookup"><span data-stu-id="6c693-156">Between the content sources and the final pages, the documentation content goes through five tooling steps:</span></span>

1. [<span data-ttu-id="6c693-157">プリプロセッサ スクリプト</span><span class="sxs-lookup"><span data-stu-id="6c693-157">Preprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/preprocessor.ts)
1. [<span data-ttu-id="6c693-158">API 抽出器</span><span class="sxs-lookup"><span data-stu-id="6c693-158">API Extractor</span></span>](https://api-extractor.com/)
1. [<span data-ttu-id="6c693-159">Midprocessor スクリプト</span><span class="sxs-lookup"><span data-stu-id="6c693-159">Midprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/midprocessor.ts)
1. [<span data-ttu-id="6c693-160">API Documenter</span><span class="sxs-lookup"><span data-stu-id="6c693-160">API Documenter</span></span>](https://github.com/microsoft/rushstack/blob/master/apps/api-documenter/README.md)
1. [<span data-ttu-id="6c693-161">ポストプロセッサ スクリプト</span><span class="sxs-lookup"><span data-stu-id="6c693-161">Postprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/postprocessor.ts)

<span data-ttu-id="6c693-162">プリプロセッサは d.ts ファイルを取得し、ホスト固有のセクションに分割します。</span><span class="sxs-lookup"><span data-stu-id="6c693-162">The preprocessor takes the d.ts files and splits them into host-specific sections.</span></span> <span data-ttu-id="6c693-163">後続のツールがデータを適切に処理するために必要なクリーンアップを実行します。</span><span class="sxs-lookup"><span data-stu-id="6c693-163">It performs any cleanup necessary for the subsequent tools to properly process the data.</span></span>

<span data-ttu-id="6c693-164">API 抽出器は、d.ts ファイルを JSON データに変換します。</span><span class="sxs-lookup"><span data-stu-id="6c693-164">API Extractor converts the d.ts files into JSON data.</span></span> <span data-ttu-id="6c693-165">これにより、すべての型データがトークン化され、解析が容易になります。</span><span class="sxs-lookup"><span data-stu-id="6c693-165">This tokenizes all the type data, allowing for easier parsing.</span></span>

<span data-ttu-id="6c693-166">Midprocessor は、コード スニペットを取得し、それらを適切なホストとペアにし、Outlook と共通 API オブジェクトの間の問題をクリーンアップします。</span><span class="sxs-lookup"><span data-stu-id="6c693-166">The midprocessor retrieves the code snippets and pairs them with the proper hosts, and cleans up the crosslinking between Outlook and Common API objects.</span></span>

<span data-ttu-id="6c693-167">API Documenter は JSON データを .yml ファイルに変換します。</span><span class="sxs-lookup"><span data-stu-id="6c693-167">API Documenter converts the JSON data into .yml files.</span></span> <span data-ttu-id="6c693-168">.yml ファイルは、ドキュメントを公開する Open Publishing System によってマークダウンdocs.microsoft.com。</span><span class="sxs-lookup"><span data-stu-id="6c693-168">The .yml files are converted to markdown by the Open Publishing System that publishes our docs to docs.microsoft.com.</span></span> <span data-ttu-id="6c693-169">API Documenter には、コード スニペットをOffice固有の拡張機能も含めます。</span><span class="sxs-lookup"><span data-stu-id="6c693-169">API Documenter also contains an Office-specific extension that inserts our code snippets.</span></span>

<span data-ttu-id="6c693-170">ポストプロセッサは目次をクリーンアップし、.yml ファイルを発行フォルダー [に移動します](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen)。</span><span class="sxs-lookup"><span data-stu-id="6c693-170">The postprocessor cleans up the table of contents and moves the .yml files into the [publishing folder](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span></span>

<span data-ttu-id="6c693-171">これらの 5 つの手順はすべて [、GenerateDocs.cmd を実行すると](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) 実行されます。</span><span class="sxs-lookup"><span data-stu-id="6c693-171">All five of these steps are performed when [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) is run.</span></span> <span data-ttu-id="6c693-172">このスクリプトは、ノード モジュールのインストールの処理、古いファイル セットの削除、および各要件セットの型定義ファイルのバージョンも処理します。</span><span class="sxs-lookup"><span data-stu-id="6c693-172">That script also handles node module installation, cleans out old file sets, and versions Type Definition files for each requirement set.</span></span>
